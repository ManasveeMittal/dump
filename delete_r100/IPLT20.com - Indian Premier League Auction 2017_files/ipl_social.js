if(PULSE.app.templates["facebook-card"]=_.template('<div class="social-feed-card__social-logo social-feed-card__social-logo--facebook"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-facebook"></use></svg> </div> <div class="social-feed-card social-feed-card--facebook <% if (typeof photo === \'undefined\' || !photo) { %> social-feed-card--no-media <% } %>"> <% if (typeof photo !== \'undefined\' && photo) { %> <div class="social-feed-card__image"> <a href="<%= link %>" target="_blank" class="social-feed-card__imagelink"> <img src="<%= photo %>" alt=""> <span class="u-screen-reader">View <%= user.name %> post on Facebook</span> </a> </div> <% } %> <div class="social-feed-card__content-container"> <div class="social-feed-card__brand-line"></div> <div class="social-feed-card__content <% if (!photo) { %> social-feed-card__content--large <% } %>"> <div class="social-feed-card__content-header"> <span class="social-feed-card__content-account"><%= user.name %></span> &bull; <a href="<%= link %>" target="_blank" rel="nofollow" class="social-feed-card__time"><%= timestamp %></a> </div> <div class="social-feed-card__content-body"> <%= text %> </div> <div class="social-feed-card__share-options"> <div class="social-feed-card__share-container"> <a href="<%= link %>" target="_blank" rel="nofollow"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-facebook-share"></use></svg> <span class="u-screen-reader"> on Facebook</span> </a> </div> </div> </div> </div> </div>'),PULSE.app.templates["instagram-card"]=_.template('<div class="social-feed-card__social-logo social-feed-card__social-logo--instagram"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-instagram"></use></svg> </div> <div class="social-feed-card social-feed-card--instagram <% if (typeof photo === \'undefined\' || !photo) { %> social-feed-card--no-media <% } %>"> <% if (typeof photo !== \'undefined\' && photo) { %> <div class="social-feed-card__image"> <a href="<%= link %>" target="_blank" class="social-feed-card__imagelink"> <img src="<%= photo %>" alt=""> <span class="u-screen-reader">View <%= user.name %> post on Instagram</span> </a> </div> <% } %> <div class="social-feed-card__content-container"> <div class="social-feed-card__brand-line"></div> <div class="social-feed-card__content <% if (!photo) { %> social-feed-card__content--large <% } %>"> <div class="social-feed-card__content-header"> <span class="social-feed-card__content-account"><%= user.name %></span> &bull; <a href="<%= link %>" target="_blank" rel="nofollow" class="social-feed-card__time"><%= timestamp %></a> </div> <div class="social-feed-card__content-body"> <%= text %> </div> <div class="social-feed-card__share-options"> <div class="social-feed-card__share-container"> <a href="<%= link %>" target="_blank" rel="nofollow"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-insta-like"></use></svg> <span class="u-screen-reader">Favourite on Instagram</span> </a> <a href="<%= link %>" target="_blank" rel="nofollow"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-insta-comment"></use></svg> <span class="u-screen-reader">Comment on Instagram</span> </a> </div> </div> </div> </div> </div>'),PULSE.app.templates.paginator=_.template('<% for (var i = 0; i < slideNum; i++) { %> <% var currentPage = i + 1 %> <li class="content-slider__pager-container js-pager-container"> <button class="content-slider__pager js-pager" aria-label="Goto Page <%= currentPage %>"> <span class="u-screen-reader"><%= currentPage %></span></button> </li> <% } %>'),PULSE.app.templates["social-feed"]=_.template('<% items.forEach( function( item, index ) { %> <div class="content-slider__item js-thumb"> <%= item.subTemplate %> </div> <% }); %>'),PULSE.app.templates["twitter-card"]=_.template('<div class="social-feed-card__social-logo social-feed-card__social-logo--twitter"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-twitter"></use></svg> </div> <div class="social-feed-card social-feed-card--twitter <% if (typeof photo === \'undefined\' || !photo) { %> social-feed-card--no-media <% } %>"> <% if (typeof photo !== \'undefined\' && photo) { %> <div class="social-feed-card__image"> <a href="<%= link %>" target="_blank" class="social-feed-card__imagelink"> <img src="<%= photo %>" alt=""> <span class="u-screen-reader">View <%= user.name %> post on Twitter</span> </a> </div> <% } %> <div class="social-feed-card__content-container"> <div class="social-feed-card__brand-line"></div> <div class="social-feed-card__content <% if ( typeof photo == \'undefined\') { %> social-feed-card__content--large <% } %>"> <div class="social-feed-card__content-header"> <span class="social-feed-card__content-account"><% if (typeof user !== \'undefined\') { %><%= user.name %><% } %></span> <% if (typeof user !== \'undefined\') { %>@<%= user.account %><% } %> &bull; <a href="<%= link %>" target="_blank" rel="nofollow" class="social-feed-card__time"><% if (typeof timestamp !== \'undefined\') { %><%= timestamp %><% } %></a> </div> <div class="social-feed-card__content-body"> <% if (typeof text !== \'undefined\') { %><%= text %><% } %> </div> <div class="social-feed-card__share-options"> <div class="social-feed-card__share-container"> <a href="https://twitter.com/intent/tweet?in_reply_to=<% if (typeof idTrimmed !== \'undefined\') { %><%= idTrimmed %><% } %>" target="_blank" rel="nofollow"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-twitter-comment"></use></svg> <span class="u-screen-reader">Reply on Twitter</span> </a> <a href="https://twitter.com/intent/retweet?tweet_id=<% if (typeof idTrimmed !== \'undefined\') { %><%= idTrimmed %><% } %>" target="_blank" rel="nofollow"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-twitter-share"></use></svg> <span class="u-screen-reader">Retweet on Twitter</span> </a> <a href="https://twitter.com/intent/like?tweet_id=<% if (typeof idTrimmed !== \'undefined\') { %><%= idTrimmed %><% } %>" target="_blank" rel="nofollow"> <svg class="icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/ver/i/svg-output/icons.svg#icn-twitter-like"></use></svg> <span class="u-screen-reader">Favourite on Twitter</span> </a> </div> </div> </div> </div> </div>'),PULSE.app.templates["player-battle"]=_.template('<div class="player-battles__battle player-battle" data-feeds="<%= players[0].feed_name %>-<%= players[1].feed_name %>"> <div class="player-battle__match"> <span><%= matchInfo.description %></span> <%= matchInfo.team1.team.abbreviation %> v <%= matchInfo.team2.team.abbreviation %> <a href="<%= matchLink %>" class="viewmatch">View Match</a> <a href="<%= matchLink %>" class="recap">Recap</a> </div> <div class="player-battle__players"> <div class="player left"> <div class="teamLogo <%= players[0].team.abbreviation %>"></div> <div class="photo" data-player-id="<%= players[0].id %>"><img src="" alt=""></div> <p class="firstName"><%= players[0].player.names[0] %></p> <p class="secondName"><%= players[0].player.names[1] %></p> <div class="percent"><%= players[0].percentage %><span>%</span></div> <div class="completeChart"> <div class="barContainer"> <div class="bar left <%= players[0].team.abbreviation %>" style="height: <%= players[0].percentage %>%"> <div class="count"><%= players[0].percentage %><span>%</span></div> </div> </div> <div class="name"><%= players[0].player.fullName %></div> </div> <a href="#" class="vote" data-hashtag="<%= players[0].hashtag %>"> <span class="icon"></span>Vote for #<%= players[0].hashtag %> </a> </div> <div class="player right"> <div class="teamLogo <%= players[1].team.abbreviation %>"></div> <div class="photo" data-player-id="<%= players[1].id %>"><img src="" alt=""></div> <p class="firstName"><%= players[1].player.names[0] %></p> <p class="secondName"><%= players[1].player.names[1] %></p> <div class="percent"><%= players[1].percentage %><span>%</span></div> <div class="completeChart"> <div class="barContainer"> <div class="bar right <%= players[1].team.abbreviation %>" style="height: <%= players[1].percentage %>%"> <div class="count"><%= players[1].percentage %><span>%</span></div> </div> </div> <div class="name"><%= players[1].player.fullName %></div> </div> <a href="#" class="vote" data-hashtag="<%= players[1].hashtag %>"> <span class="icon"></span>Vote for #<%= players[1].hashtag %> </a> </div> <div class="vsGraphics"> <div class="bird"><div class="icon"></div></div> <div class="vs">Vs</div> </div> </div> <div class="player-battle__voting"> <div class="barContainer"> <div class="left bar <%= players[0].team.abbreviation %>" style="width: <%= players[0].percentage %>%"></div> <div class="right bar <%= players[1].team.abbreviation %>" style="width: <%= players[1].percentage %>%"></div> </div> <div class="meta"> <div class="votes">Total Votes:<span><%= total %></span></div> </div> </div> </div>'),PULSE.app.templates["playing-xi-voting-match"]=_.template('<div class="js-match match-list__item u-negative-margin-phablet result" data-match-id="<%= match.matchId %>" data-team-ids="<%= match.team1id %>,<%= match.team2id %>" data-venue-id="<%= match.venue.id %>"> <div class="result__venue" data-widget="match-venue-image" data-venue-id="<%= match.venue.id %>" data-photo-variant="Article - Small"></div> <p class="result__outcome u-show-phablet"><%= match.matchSummary %></p> <div class="result__teams"> <div class="result__team <%= match.team2won ? \'result__team--loser\' : \'\' %>"> <div class="result__logo u-show-phablet tLogo30x <%= match.team1abbr %>"></div> <div class="result__logo u-hide-phablet tLogo50x <%= match.team1abbr %>"></div> <p class="result__team-name"><%= match.team1fullName %></p> <span class="result__score <%= match.team1won ? \'result__score--winner\' : \'\' %>"><% _.each( match.team1innings, function( innings ) { %> <%= innings %> <% } ); %></span> </div> <div class="result__team <%= match.team1won ? \'result__team--loser\' : \'\' %>"> <div class="result__logo u-show-phablet tLogo30x <%= match.team2abbr %>"></div> <div class="result__logo u-hide-phablet tLogo50x <%= match.team2abbr %>"></div> <p class="result__team-name"><%= match.team2fullName %></p> <span class="result__score <%= match.team2won ? \'result__score--winner\' : \'\' %>"><% _.each( match.team2innings, function( innings ) { %> <%= innings %> <% } ); %></span> </div> <p class="result__info u-show-phablet"> <%= match.matchDescription %>, <%= match.formattedMatchDate %>, <%= match.venue.shortName || match.venue.fullName %>, <%= match.venue.city %> </p> </div> <div class="result__links"> <p class="result__outcome u-hide-phablet"><%= match.matchSummary %></p> <p class="result__info u-hide-phablet"> <%= match.matchDescription %>, <%= match.formattedMatchDate %>, <%= match.venue.shortName || match.venue.fullName %>, <%= match.venue.city %> </p> <a class="result__button btn btn--has-chev" href="<%= match.matchLink %>">Playing XI Vote</a> </div> </div>'),PULSE.app.templates["playing-xi-voting-matches"]=_.template("<% _.each( matches, function( match ) { %> <%= PULSE.app.templating.render( { \"match\": match }, 'playing-xi-voting-match' ) %> <% } ); %>"),PULSE.app.templates.facebook=_.template('<div class="social-item fade-in social-item--facebook <%= item.photo ? \'social-item--image\' : \'\' %>" style="background-image:url(\'<%= item.photo %>\')"> <div class="social-item__service-logo social-item__service-logo--rounded social-item__service-logo--facebook"></div> <div class="social-item__container"> <div class="social-item__user"> <div class="social-item__avatar" style="background-image:url(\'<%= item.user.avatarUrl %>\')"></div> <div class="social-item__user-meta"> <a href="<%= item.user.link %>" class="social-item__user-name"><%= item.user.name %></a> <a href="<%= item.link %>" target="_BLANK" class="social-item__timestamp"> <span class="social-item__timestamp-value"><%= item.timestamp %></span> ago </a> </div> </div> <div class="social-item__text"> <%= item.text %> </div> </div> </div>'),PULSE.app.templates.instagram=_.template('<div class="social-item fade-in social-item--instagram <%= item.photo ? \'social-item--image\' : \'\' %>" style="background-image:url(\'<%= item.photo %>\')"> <div class="social-item__service-logo social-item__service-logo--rounded social-item__service-logo--instagram"></div> <div class="social-item__container"> <div class="social-item__user"> <div class="social-item__avatar" style="background-image:url(\'<%= item.user.avatarUrl %>\')"></div> <div class="social-item__user-meta"> <a href="<%= item.user.link %>" class="social-item__user-name"><%= item.user.name %></a> <a href="<%= item.link %>" target="_BLANK" class="social-item__timestamp"> <span class="social-item__timestamp-value"><%= item.timestamp %></span> ago </a> </div> </div> <div class="social-item__text"> <%= item.text %> </div> </div> </div>'),PULSE.app.templates.twitter=_.template('<div class="social-item fade-in social-item--twitter <%= item.user.account === \'IPLselfie\' ? \'social-item--ipl-selfie\' : \'\' %> <%= item %> <%= item.photo ? \'social-item--image\' : \'\' %>" style="background-image:url(\'<%= item.photo %>\')"> <div class="social-item__service-logo social-item__service-logo--twitter"></div> <% if( item.photo ) { %><div class="social-item__container"> <% } %> <div class="social-item__user"> <div class="social-item__avatar" style="background-image:url(\'<%= item.user.avatarUrl %>\')"></div> <div class="social-item__user-meta"> <a href="<%= item.user.link %>" class="social-item__user-name"><%= item.user.name %></a> <a href="<%= item.link %>" target="_BLANK" class="social-item__timestamp"> <span class="social-item__timestamp-value"><%= item.timestamp %></span> ago </a> </div> </div> <div class="social-item__text"> <%= item.text %> </div> <div class="social-item__intents"> <a onclick="PULSE.CLIENT.TwitterController.tweetEvent(\'tweet\',{in_reply_to:\'<%= item.id %>\'})" href="" class="social-item__intent social-item__intent--reply"></a> <a onclick="PULSE.CLIENT.TwitterController.tweetEvent(\'retweet\',{tweet_id:\'<%= item.id %>\'})" href="" class="social-item__intent social-item__intent--retweet"></a> <a onclick="PULSE.CLIENT.TwitterController.tweetEvent(\'favorite\',{tweet_id:\'<%= item.id %>\'})" href="" class="social-item__intent social-item__intent--favourite"></a> </div> <% if( item.photo ) { %></div><% } %> </div>'),PULSE.app.templates.social_tally_large=_.template('<div class="social-block__content"> <div class="social-block__hash-tag">#IPL</div> <div class="social-block__count"><span class="social-block__tally js-tally"></span></div> <span class="social-block__count-text">Tweets and Counting</span> <div class="social-block__trending"> <div class="top-team" data-widget="social-ranked-team" data-template="top_team"></div> <a onclick="PULSE.CLIENT.TwitterController.tweetEvent(\'tweet\',{hashtags:[\'VIVOIPL\']})" class="social-block__button">Join The Conversation</a> </div> </div>'),PULSE.app.templates.team_tally_large=_.template('<div class="social-block__content <%= abbreviation %>"> <div class="social-block__hash-tag">#<%= abbreviation %></div> <div class="social-block__count"><span class="social-block__tally js-tally"></span></div> <span class="social-block__count-text">Tweets and Counting</span> <div class="social-block__trending social-block__trending--team"> <a onclick="PULSE.CLIENT.TwitterController.tweetEvent(\'tweet\',{hashtags:[\'<%= abbreviation %>\']})" class="social-block__button">Join The Conversation</a> </div> </div>'),PULSE.app.templates.top_team=_.template('<div class="top-team__logo-container"> <div class="tLogo40x <%= abbreviation %>"></div> </div> <div class="top-team__top-team-details"> <div class="top-team__title">Top Trending Team</div> <div class="top-team__total">#<%= label %><span><%= formattedCount %></span></div> </div>'),!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.TwitterMirror=function(t,e){this.$container=$(t),this.config=e,this.account=e["data-feed-name"]||"IPLSelfieOfficial_List",this.tweets=[],this.initialized=!1,this.twitterUtils=PULSE.CLIENT.getTwitterInstance();PULSE.CLIENT.TwitterController;this.template="twitter-mirror-card",this.getData(!0),this.addListeners()},PULSE.CLIENT.CRICKET.TwitterMirror.prototype.addListeners=function(){var t=this;$("body").on("twitter/list",function(e,a){a.success&&t.updateMirror()}),$("body").on("click","#js-cards .icons a",function(t){t.stopPropagation()}),$("body").on("click","#js-cards ul li",function(t){t.preventDefault();var e=$(this).attr("data-id"),a="//twitter.com/IPL/status/"+e;window.location=a})},PULSE.CLIENT.CRICKET.TwitterMirror.prototype.getData=function(t){this.twitterUtils.getList(this.account,{fileName:this.account,start:this.config.start||t,interval:"undefined"!=typeof this.config.interval?this.config.interval:60})},PULSE.CLIENT.CRICKET.TwitterMirror.prototype.updateMirror=function(){var t=this.twitterUtils.getTweetsListModel(this.account),e=this;this.initialized?(this.deleteRemoved(t),this.addNew(t)):PULSE.CLIENT.Template.publish(this.template,this.$container.find("#js-cards ul"),t,function(){var a=imagesLoaded("#js-cards");a.on("progress",function(t,e){e.isLoaded||$(e.img).parents(".masonry-brick").remove()}),a.on("always",function(){e.$container.find("#js-cards").masonry({columnWidth:240,itemSelector:".twitter-mirror__card",isFitWidth:!0,isAnimated:!Modernizr.csstransitions})});for(var i=0;i<t.tweets.length;i++)e.tweets.push(t.tweets[i].id);e.initialized=!0})},PULSE.CLIENT.CRICKET.TwitterMirror.prototype.deleteRemoved=function(t){for(var e=0;e<this.tweets.length;e++){for(var a=!1,i=0;i<t.tweets.length;i++)t.tweets[i].id===this.tweets[e]&&(a=!0);if(!a){var s=this.$container.find("#js-cards li[data-id="+this.tweets[e]+" ]");this.$container.find("#js-cards").masonry("remove",s),this.tweets.splice(e,1)}}},PULSE.CLIENT.CRICKET.TwitterMirror.prototype.addNew=function(t){for(var e=this,a=0;a<t.tweets.length;a++)if(this.tweets.indexOf(t.tweets[a].id)===-1){var i={tweets:[t.tweets[a]]},s=PULSE.CLIENT.Template.getHtml(this.template,i);this.$container.find("#js-cards ul").prepend(s);var n=imagesLoaded("#js-cards");n.on("progress",function(t,e){e.isLoaded||$(e.img).parents(".masonry-brick").remove()}),n.on("always",function(){e.$container.find("#js-cards").masonry("reloadItems").masonry()}),e.tweets.push(t.tweets[a].id)}},window.WidgetController.init("twitter-mirror",PULSE.CLIENT.CRICKET.TwitterMirror),!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayerBattles||(PULSE.CLIENT.CRICKET.PlayerBattles={}),PULSE.CLIENT.CRICKET.PlayerBattles.Main=function(t,e,a){this.$container=$(t),this.config=e,this.tournament=a,this.urlFactory=this.tournament.tournamentUrlGenerator,this.$moreButton=this.$container.find(".js-more"),this.$currentBattle=this.$container.find(".js-current-battle-container"),this.$nextBattle=this.$container.find(".js-next-battle-container"),this.$upcomingBattles=this.$container.find(".js-upcoming-battles-container"),this.$previousBattles=this.$container.find(".js-previous-battles-container"),this.twitter=PULSE.CLIENT.getTwitterInstance(),this.renderer=new PULSE.CLIENT.CRICKET.PlayerBattles.Renderer(t,e,a),this.renderer.$moreButton=this.$moreButton,this.renderer.$currentBattle=this.$currentBattle,this.renderer.$nextBattle=this.$nextBattle,this.renderer.$upcomingBattles=this.$upcomingBattles,this.renderer.$previousBattles=this.$previousBattles,this.battle={},this.expectedBattles=[],this.expectedHistoricBattles=[],this.collectedHistoricBattles=[],this.expectedHistoricFeeds=[],this.expectedFeeds=[],this.collectedFeeds=[],this.collectedHistoricFeeds=[],this.collectedBattles=[],this.historicLimit=6,this.hasMetadata=!1,this.hasSquads=!1,this.hasSchedule=!1,PULSE.squads&&PULSE.schedules&&PULSE.schedules[this.tournament.tournamentName]&&(this.tournament.scheduleData=PULSE.schedules[this.tournament.tournamentName].map(function(t){return t.scheduleEntry}),this.tournament.updateMatches(),this.tournament.squadsData=PULSE.squads,this.tournament.getPlayerBattlesMetadata(!0),this.hasSchedule=!0,this.hasSquads=!0),this.setSubscriptions(),this.setListeners()},PULSE.CLIENT.CRICKET.PlayerBattles.Main.prototype.setSubscriptions=function(){var t=this;$("body").on("playerBattles/update",function(e,a){a.success&&(t.clearData(),PULSE.CLIENT.CRICKET.PlayerBattles.Metadata=t.tournament.playerBattlesMetadata,t.parseMetadata())}),$("body").on("twitter/tally",function(e,a){a.success&&t.handleFeed(a.name)})},PULSE.CLIENT.CRICKET.PlayerBattles.Main.prototype.setListeners=function(){var t=this;$("body").on("click",".vote",function(t){t.preventDefault();var e=$(this).attr("data-hashtag"),a="tweet",i={text:"I'm backing #"+e+" in the @IPL #PlayerBattles. Vote for your choice now https://bit.ly/P3gs0x #VIVOIPL"};PULSE.CLIENT.TwitterController.tweetEvent(a,i)}),this.$moreButton.on("click",function(e){e.preventDefault(),t.historicLimit+=6,t.expectedHistoricBattles.length>0&&t.getNextHistoricBattle()})},PULSE.CLIENT.CRICKET.PlayerBattles.Main.prototype.clearData=function(){$("body").find(".js-battle").remove(),this.collectedFeeds=[],this.collectedBattles=[],this.collectedHistoricFeeds=[],this.collectedHistoricBattles=[]},PULSE.CLIENT.CRICKET.PlayerBattles.Main.prototype.parseMetadata=function(){this.tournament.playerBattlesMetadata&&(this.metadata=PULSE.CLIENT.CRICKET.PlayerBattles.Metadata);for(var t=0;t<this.metadata.battles.length;t++){var e=this.metadata.battles[t];e.stopped?this.expectedHistoricBattles.push(e):_.indexOf(this.metadata.current,e.match)>-1?this.expectedBattles.push(e):this.renderer.renderBattle(e)}this.expectedHistoricBattles.reverse(),this.expectedBattles.length>0&&this.getNextBattle(),this.expectedHistoricBattles.length>0&&this.getNextHistoricBattle()},PULSE.CLIENT.CRICKET.PlayerBattles.Main.prototype.getNextBattle=function(){var t;for(this.battle=this.expectedBattles[0],t=0;t<this.battle.players.length;t++){var e=this.battle.players[t];this.expectedFeeds.push(e.feed_name)}for(t=0;t<this.expectedFeeds.length;t++){var a=this.expectedFeeds[t],i={fileName:a,start:!0,interval:30};this.twitter.getTally(a,i)}},PULSE.CLIENT.CRICKET.PlayerBattles.Main.prototype.getNextHistoricBattle=function(){var t;for(this.historicBattle=this.expectedHistoricBattles[0],t=0;t<this.historicBattle.players.length;t++){var e=this.historicBattle.players[t];this.expectedHistoricFeeds.push(e.feed_name)}for(t=0;t<this.expectedHistoricFeeds.length;t++){var a=this.expectedHistoricFeeds[t],i={fileName:a,start:!0,interval:0};this.twitter.getTally(a,i)}},PULSE.CLIENT.CRICKET.PlayerBattles.Main.prototype.handleFeed=function(t){var e,a=t,i=_.indexOf(this.expectedFeeds,a);i>-1&&(e=this.expectedFeeds.splice(i,1)[0],this.collectedFeeds.push(e),0===this.expectedFeeds.length&&(this.collectedBattles.push(this.expectedBattles.shift()),this.renderer.renderBattle(this.battle),this.expectedBattles.length>0&&this.getNextBattle()));var s=_.indexOf(this.expectedHistoricFeeds,a);s>-1&&(e=this.expectedHistoricFeeds.splice(s,1),this.collectedHistoricFeeds.push(e),0===this.expectedHistoricFeeds.length&&(this.collectedHistoricBattles.push(this.expectedHistoricBattles.shift()),this.renderer.renderBattle(this.historicBattle),this.expectedHistoricBattles.length>0&&this.collectedHistoricBattles.length<=this.historicLimit?this.getNextHistoricBattle(!0):this.expectedHistoricBattles.length>0?this.$moreButton.show():0===this.expectedHistoricBattles.length&&this.$moreButton.hide()));var n=this.collectedFeeds.concat(this.collectedHistoricFeeds),o=_.indexOf(n,a);if(o>-1)for(var r=this.collectedBattles.concat(this.collectedHistoricBattles),l=0;l<r.length;l++){var c=r[l];if(c)for(var d=0;d<c.players.length;d++)this.renderer.isCurrent(c.match)&&c.players[d].feed_name==a&&this.renderer.renderBattle(c)}},!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayerBattles||(PULSE.CLIENT.CRICKET.PlayerBattles={}),PULSE.CLIENT.CRICKET.PlayerBattles.Renderer=function(t,e,a){this.$container=$(t),this.config=e,this.tournament=a,this.twitter=PULSE.CLIENT.getTwitterInstance(),this.templates={battleCard:"player-battle"}},PULSE.CLIENT.CRICKET.PlayerBattles.Renderer.prototype.renderBattle=function(t){this.metadata=PULSE.CLIENT.CRICKET.PlayerBattles.Metadata;var e=this,a=this.getPlayerBattleModel(t),i=this.getContainer(a),s=this.templates.battleCard;PULSE.CLIENT.Template.publish(s,i,a,function(){i.find(".photo").each(function(){e.tournament.tournamentUrlGenerator.setPlayerImageLoader($(this).attr("data-player-id"),"284",$(this))}),e.toggleColumnHeaders()})},PULSE.CLIENT.CRICKET.PlayerBattles.Renderer.prototype.getPlayerBattleModel=function(t){for(var e=t,a=0;a<e.players.length;a++){var i=e.players[a];i.team=this.tournament.getTeamByPlayerId(i.id),i.player=this.tournament.getPlayerById(i.id),i.player.names=i.player.fullName.replace(" ","/").split("/"),i.hashtag=this.lookUpHashtag(i.id),i.count=this.twitter.getTweetCount(i.feed_name).replace(",","").replace(",","")}e.matchInfo=this.tournament.getMatchById(e.match).scheduleData,e.matchLink=this.tournament.tournamentUrlGenerator.getMatchURL(e.match),e.isCurrent=this.isCurrent(e.match),e.total=this.getTotalVotes(e.players);for(var s=0,a=0;a<e.players.length;a++){var n=0,o=e.players[a].count;if(o&&o.length>0&&(n=parseInt(o)),e.total>0){var r=Math.round(n/e.total*100);e.players[a].percentage=r,s+=r}else e.players[a].percentage=50}return s>100&&e.players&&2===e.players.length&&(e.players[1].percentage=100-e.players[0].percentage),e.total=PULSE.CLIENT.Util.commafy(e.total),e},PULSE.CLIENT.CRICKET.PlayerBattles.Renderer.prototype.lookUpHashtag=function(t){if(_.has(this.metadata.hashtags,t))return this.metadata.hashtags[t]},PULSE.CLIENT.CRICKET.PlayerBattles.Renderer.prototype.getTotalVotes=function(t){for(var e=0,a=0;a<t.length;a++){var i=t[a].count;i&&i.length>0&&(e+=parseInt(i))}return e},PULSE.CLIENT.CRICKET.PlayerBattles.Renderer.prototype.isCurrent=function(t){return _.indexOf(this.metadata.current,t)>-1},PULSE.CLIENT.CRICKET.PlayerBattles.Renderer.prototype.getContainer=function(t){if(t.isCurrent){var e=t.players[0].feed_name+"-"+t.players[1].feed_name,a=this.$currentBattle.find("[data-feeds='"+e+"']");if(a.length>0)return a.parent()}var i=$('<div class="js-battle"></div>');return t.stopped?this.$previousBattles.append(i):t.isCurrent?this.$currentBattle.append(i):0===this.$nextBattle.children().length?this.$nextBattle.append(i):this.$upcomingBattles.append(i),i},PULSE.CLIENT.CRICKET.PlayerBattles.Renderer.prototype.toggleColumnHeaders=function(){this.$container.find(".js-current-battle-header").toggle(this.$currentBattle.children().length>0),this.$container.find(".js-next-battle-header").toggle(this.$nextBattle.children().length>0),this.$container.find(".js-upcoming-battles-header").toggle(this.$upcomingBattles.children().length>1),this.$container.find(".js-previous-battles-header").toggle(this.$previousBattles.children().length>1)},window.WidgetController.init("player-battles",PULSE.CLIENT.CRICKET.PlayerBattles.Main),!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayerVote||(PULSE.CLIENT.CRICKET.PlayerVote={}),PULSE.CLIENT.CRICKET.PlayerVote.StateManager=function(t,e){this.$container=t,this.match=e,this.tournament=this.match.tournament,this.setSubscriptions(),this.tournament.playerVoteQuestionsData.length?this.changeState():this.tournament.getPlayerVoteQuestionsData(!0)},PULSE.CLIENT.CRICKET.PlayerVote.StateManager.prototype.setSubscriptions=function(){var t=this;$("body").on("player-vote/state/update",function(e,a){a.matchId===t.match.matchId&&t.changeState()}),$("body").on("player-vote/config",function(e,a){a.success===!1&&console.log("unable to retrieve team voting config for "+t.tournament.tournamentName)})},PULSE.CLIENT.CRICKET.PlayerVote.StateManager.prototype.changeState=function(){this.match.isPlayerVotingOpen()?(console.log("trigger open voting for "+this.match.matchId),this.$container.trigger("player-vote/open",{matchId:this.match.matchId})):this.match.canShowPlayerVotingResults()?(console.log("trigger show results for "+this.match.matchId),this.$container.trigger("player-vote/results/show",{matchId:this.match.matchId})):(console.log("trigger close voting for "+this.match.matchId),this.$container.trigger("player-vote/close",{matchId:this.match.matchId}))},!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayerVote||(PULSE.CLIENT.CRICKET.PlayerVote={}),PULSE.CLIENT.CRICKET.PlayerVote.Voter=function(t,e){this.$container=t,this.match=e,this.tournament=this.match.tournament,this.setSubscriptions(),this.$voteContainer=this.$container.find("#voteView"),this.$closedContainer=this.$container.find("#closedView"),this.$resultsContainer=this.$container.find("#resultsView"),this.voteView=new PULSE.CLIENT.CRICKET.PlayerVote.VoteView(this.$voteContainer,this.match,this),this.resultsView=new PULSE.CLIENT.CRICKET.PlayerVote.ResultsView(this.$resultsContainer,this.match,this),this.stateManager=new PULSE.CLIENT.CRICKET.PlayerVote.StateManager(this.$container,this.match),console.log("create views for "+e.matchId)},PULSE.CLIENT.CRICKET.PlayerVote.Voter.prototype.setSubscriptions=function(){var t=this;this.$container.on("player-vote/open",function(e,a){t.match.matchId===a.matchId&&(t.voteOpen=!0,t.openVoting())}),this.$container.on("player-vote/close",function(e,a){t.match.matchId===a.matchId&&(t.voteOpen=!1,t.closeVoting())}),this.$container.on("player-vote/results/show",function(e,a){t.match.matchId===a.matchId&&(t.resultsShow=!0,t.showResults())}),$("body").on("player-vote/votes",function(e,a){t.match.matchId===a.matchId&&a.success&&t.showResults()}),$("body").on("squads/update",function(e,a){t.tournament.tournamentName===a.tournamentName&&a.success&&(t.resultsShow?t.showResults():t.voteOpen&&t.openVoting())})},PULSE.CLIENT.CRICKET.PlayerVote.Voter.prototype.openVoting=function(){this.hasSquadIds()&&(this.$closedContainer.hide(),this.$resultsContainer.hide(),console.log("open voting for "+this.match.matchId),this.voteView.init(this.squad1,this.squad2))},PULSE.CLIENT.CRICKET.PlayerVote.Voter.prototype.closeVoting=function(){var t=this.$container.find(".teamContainer > div");t.eq(0).addClass(this.match.getTeamAbbr(0)),t.eq(1).addClass(this.match.getTeamAbbr(1)),this.$voteContainer.hide(),this.$resultsContainer.hide(),this.$closedContainer.show()},PULSE.CLIENT.CRICKET.PlayerVote.Voter.prototype.showResults=function(){if(this.hasSquadIds())if(this.match.playerVoting.results[this.squad1Id]&&this.match.playerVoting.results[this.squad2Id]){var t=this.applySquadData(this.match.playerVoting.results[this.squad1Id]),e=this.applySquadData(this.match.playerVoting.results[this.squad2Id]);this.$voteContainer.hide(),this.$closedContainer.hide(),console.log("show results for "+this.match.matchId),this.resultsView.init(t,e)}else this.match.playerVoting.results[this.squad1Id]&&0!==this.match.playerVoting.results[this.squad1Id].length||this.match.getPlayerVoteResultsData(this.squad1Id,!0),this.match.playerVoting.results[this.squad2Id]&&0!==this.match.playerVoting.results[this.squad2Id].length||this.match.getPlayerVoteResultsData(this.squad2Id,!0)},PULSE.CLIENT.CRICKET.PlayerVote.Voter.prototype.applySquadData=function(t){var e,a=$.extend(!0,{},t),i=this.squad1,s=this.squad2;
if(i.id===a.squadId)e=i;else{if(s.id!==a.squadId)return;e=s}a.team=e.team;for(var n=0,o=a.players.length;n<o;n++){for(var r=a.players[n],l=0,c=e.players.length;l<c;l++){var d=e.players[l];if(d.id===r.id){r.nationality=d.nationality;break}}e.captainId===r.id&&(r.captain=!0),e.wicketKeeperId===r.id&&(r.wicketKeeper=!0)}return a},PULSE.CLIENT.CRICKET.PlayerVote.Voter.prototype.hasSquadIds=function(){if(0===this.tournament.squadsData.length)this.tournament.getSquads(!0);else{var t=this.match.getTeamId(0),e=this.match.getTeamId(1);if(t!==-1&&e!==-1){var a=this.tournament.getTeamById(t),i=this.tournament.getTeamById(e);if(a&&i&&a.players&&i.players&&a.players.length&&i.players.length)return this.squad1Id=a.id,this.squad2Id=i.id,this.squad1=a,this.squad2=i,!0}}return!1},!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayerVote||(PULSE.CLIENT.CRICKET.PlayerVote={}),PULSE.CLIENT.CRICKET.PlayerVote.VoteView=function(t,e,a,i){this.$container=t,this.match=e,this.parent=a,this.templates={votingList:"voting-list"},this.$intro=this.$container.find(".introScreen"),this.$votingContainer=this.$container.find(".votingContainer"),this.$voteSent=this.$container.find(".voteSubmitted"),this.$votingContainer.children().show(),this.$selectTeams=this.$container.find(".teamContainer a"),this.$selectTeam1=this.$selectTeams.eq(0),this.$selectTeam2=this.$selectTeams.eq(1),this.$squads=this.$container.find(".teamList .team"),this.$squad1=this.$squads.eq(0),this.$squad2=this.$squads.eq(1),this.$submit=this.$container.find("a.submit"),this.votingPanels=[new PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView(this.$squad1,this,this.templates.votingList),new PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView(this.$squad2,this,this.templates.votingList)],this.setEventListeners();var s=this;$("body").on("canary2/poll/voted",function(t,e){e.matchId===s.match.matchId&&(s.$voteSent.find(".otherTeam").text(s.match.getTeamAbbr(1-s.defaultTab)),s.$voteSent.show())}),$("body").on("canary2/poll/fail",function(t,e){e.matchId===s.match.matchId&&s.$voteSent.show()})},PULSE.CLIENT.CRICKET.PlayerVote.VoteView.prototype.init=function(t,e){this.squad1=t,this.squad2=e,this.$selectTeam1.addClass(t.team.abbreviation),this.$selectTeam2.addClass(e.team.abbreviation),this.$intro.show(),this.$container.show()},PULSE.CLIENT.CRICKET.PlayerVote.VoteView.prototype.setEventListeners=function(){var t=this;this.$selectTeams.each(function(){$(this).off().click(function(e){t.defaultTab=$.inArray(this,t.$selectTeams);t.loadVotingPanel(),e.preventDefault()})}),this.$submit.off().on("click",function(e){t.currentPanel&&t.currentPanel.isValid()&&t.match.playersVote(t.currentPanel.squad.id,t.currentPanel.selectedPlayers),e.preventDefault()}),this.$container.find(".voteAgain").off().click(function(e){t.reset(),e.preventDefault()}),this.$container.find(".voteForOtherTeam").off().click(function(e){t.defaultTab=1-t.defaultTab,t.votingPanels[t.defaultTab].reset(),t.loadVotingPanel(),e.preventDefault()}),this.$container.find(".socialShareBtn").off().click(function(t){$(this).siblings(".socialLinks").toggle(),t.preventDefault(),t.stopPropagation()}),$("body").on("click",function(){t.$container.find(".socialLinks").hide()}),this.$container.find(".socialShareContainer a.twitter").off().click(function(e){PULSE.CLIENT.TwitterController.tweetEvent("tweet",{text:t.getSharingText()+" @IPL",hashtags:["VIVOIPL"]}),e.preventDefault()}),this.$container.find(".socialShareContainer a.facebook").off().click(function(e){PULSE.CLIENT.FacebookController.publishEvent(t.getFullMatchLink()),e.preventDefault()}),this.$container.find(".socialShareContainer a.google").off().click(function(e){PULSE.CLIENT.GooglePlusController.publishEvent(t.getFullMatchLink()),e.preventDefault()}),this.$container.find(".socialShareContainer a.email").off().click(function(e){window.open("mailto:?subject=VIVO IPL Playing XI Voting&body="+escape(t.getSharingText())),e.preventDefault()})},PULSE.CLIENT.CRICKET.PlayerVote.VoteView.prototype.getFullMatchLink=function(){var t=window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");return t+this.match.getMatchLink()},PULSE.CLIENT.CRICKET.PlayerVote.VoteView.prototype.getSharingText=function(){var t=this.match.getTeamAbbr(this.defaultTab),e=this.getFullMatchLink();return"I have voted on my "+t+" line-up, have you? "+e},PULSE.CLIENT.CRICKET.PlayerVote.VoteView.prototype.loadVotingPanel=function(){this.$intro.hide(),this.$voteSent.hide(),this.$votingContainer.show(),this.$container.removeClass("chosen"),this.currentPanel=this.votingPanels[this.defaultTab],this["$squad"+(1+(1-this.defaultTab))].hide(),this["$squad"+(this.defaultTab+1)].show(),this.currentPanel.showVotingPanel(this["squad"+(this.defaultTab+1)])},PULSE.CLIENT.CRICKET.PlayerVote.VoteView.prototype.reset=function(){this.votingPanels[0].reset(),this.votingPanels[1].reset(),this.$squads.find("a").removeClass("active"),this.$voteSent.hide(),this.$intro.show()},!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayerVote||(PULSE.CLIENT.CRICKET.PlayerVote={}),PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView=function(t,e,a){this.$container=t,this.template=a,this.parent=e,this.selectedPlayers=[],this.overseasPlayers=[],this.$count=this.parent.$container.find(".playerCount span"),this.$overseasLimit=this.parent.$container.find(".overseasLimit"),this.canSelect=!0,this.valid=!1;var i=this;this.$container.off().on("click","a",function(t){var e=+$(this).attr("data-player-id");$(this).hasClass("active")?($(this).removeClass("active"),i.selectedPlayers=$.grep(i.selectedPlayers,function(t){return t!=e}),i.overseasPlayers=$.grep(i.overseasPlayers,function(t){return t!=e})):i.canSelect&&($(this).addClass("active"),i.selectedPlayers.push(e),i.isOverseas(e)&&i.overseasPlayers.push(e)),i.updateCount(),i.validate(),i.parent.$submit.toggleClass("active",i.valid),t.preventDefault()})},PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView.prototype.showVotingPanel=function(t){this.squad=t,PULSE.CLIENT.Template.publish(this.template,this.$container,this.squad),this.updateCount()},PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView.prototype.updateCount=function(){this.$count.html(this.selectedPlayers.length)},PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView.prototype.validate=function(){this.valid=!0,this.canSelect=!0,this.parent.$container.removeClass("chosen"),11===this.selectedPlayers.length?(this.parent.$container.addClass("chosen"),this.canSelect=!1):0===this.selectedPlayers.length&&(this.valid=!1),this.overseasPlayers.length>4?(this.parent.$container.addClass("chosen"),this.valid=!1,this.canSelect=!1,this.$overseasLimit.show()):this.$overseasLimit.hide()},PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView.prototype.isOverseas=function(t){if(this.squad)for(var e=0,a=this.squad.players.length;e<a;e++){var i=this.squad.players[e];if(i.id==t)return"Indian"!==i.nationality}return!1},PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView.prototype.isValid=function(){return this.valid},PULSE.CLIENT.CRICKET.PlayerVote.SelectPlayersView.prototype.reset=function(){this.selectedPlayers=[],this.overseasPlayers=[],this.valid=!0},!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayerVote||(PULSE.CLIENT.CRICKET.PlayerVote={}),PULSE.CLIENT.CRICKET.PlayerVote.ResultsView=function(t,e,a,i){this.$container=t,this.match=e,this.parent=a,this.selectedIdx=0,this.urlFactory=PULSE.CLIENT.CRICKET.getUrlGenerator(),this.templates={resultsList:"results-list"},this.$toggleTeams=this.$container.find(".voteToggle a"),this.$toggleTeam1=this.$toggleTeams.eq(0),this.$toggleTeam2=this.$toggleTeams.eq(1),this.$resultsTeams=this.$container.find(".resultsTab"),this.$resultsTeam1=this.$resultsTeams.eq(0),this.$resultsTeam2=this.$resultsTeams.eq(1);var s=this;this.$container.find(".voteToggle").children().off().removeClass("active"),this.toggler=new PULSE.CLIENT.UI.ToggleNav({activeTab:0,navigationContainer:this.$container.find(".voteToggle"),contentContainer:this.$container.find(".resultsContainer"),contentClassPrefix:"xitab",callback:function(t){s.selectedIdx=t;var e=t+1;if(!s["published"+e]){s.addPercentages();var a=s.splitOutXI();PULSE.CLIENT.Template.publish(s.templates.resultsList,s["$resultsTeam"+e],a),s.updateHeadshots(),s["published"+e]=!0}}}),this.$container.find(".notification").off().click(function(t){$(this).toggleClass("noPulse"),s.$container.toggleClass("showResults"),t.preventDefault()})},PULSE.CLIENT.CRICKET.PlayerVote.ResultsView.prototype.init=function(t,e){this.votingData1=t,this.votingData2=e,this.$toggleTeam1.html(t.team.abbreviation),this.$toggleTeam2.html(e.team.abbreviation),this.addPercentages();var a=this.splitOutXI();PULSE.CLIENT.Template.publish(this.templates.resultsList,this.$resultsTeam1,a),this.updateHeadshots(),this.published1=!0,this.$container.show()},PULSE.CLIENT.CRICKET.PlayerVote.ResultsView.prototype.updateHeadshots=function(){var t=this;this.$container.find(".playerPhoto").each(function(){t.urlFactory.setPlayerImageLoader($(this).attr("data-player-id"),"65x75",$(this))})},PULSE.CLIENT.CRICKET.PlayerVote.ResultsView.prototype.addPercentages=function(){for(var t=this["votingData"+(this.selectedIdx+1)],e=0,a=t.players.length;e<a;e++){var i=t.players[e];0===t.totalVotes?i.percentage=i.formattedPercentage=0:(i.percentage=100*i.voteCount/t.totalVotes,i.formattedPercentage=Math.floor(100*i.percentage)/100)}},PULSE.CLIENT.CRICKET.PlayerVote.ResultsView.prototype.splitOutXI=function(){var t=this.match.getPlayingXI(this.selectedIdx),e=this["votingData"+(this.selectedIdx+1)],a=[],i=[];t:for(var s=0,n=e.players.length;s<n;s++){for(var o=e.players[s],r=0,l=t.players.length;r<l;r++){var c=t.players[r];if(c.id==o.id){a.push(o);continue t}}i.push(o)}return{xi:a,others:i}},!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayingXIHub||(PULSE.CLIENT.CRICKET.PlayingXIHub={}),PULSE.CLIENT.CRICKET.PlayingXIHub.Matches=function(t,e){this.$container=t,this.tournament=e,this.template="playing-xi-voting-matches",this.urlGenerator=PULSE.CLIENT.CRICKET.getUrlGenerator(),this.votingPanels={},this.$votingModal=this.$container.closest("[data-widget]").find(".js-modal"),this.setSubscriptions(),this.setEventListeners()},PULSE.CLIENT.CRICKET.PlayingXIHub.Matches.prototype.setSubscriptions=function(){var t=this;$("body").on("scoring/update",function(e,a){a.success&&t.tournament.getMatchById(a.matchId)&&t.updateMatch(a.matchId)})},PULSE.CLIENT.CRICKET.PlayingXIHub.Matches.prototype.setEventListeners=function(){var t=this;this.$container.on("click",".js-open-modal",function(e){var a=$(this).attr("data-match-id");t.openModal(a),e.preventDefault()});var e=function(e){e.matches?t.$container.off("click",">li").on("click",">li",function(){var e=$(this).find("[data-match-id]").first().data("match-id");t.openModal(e)}):t.$container.off("click",">li")};this.mobileMediaQuery=window.matchMedia("screen and (max-width: 950px)"),this.mobileMediaQuery.addListener(e),e(this.mobileMediaQuery),t.$votingModal.find(".modal-close").on("click",function(e){t.$votingModal.removeClass("active"),e.preventDefault()})},PULSE.CLIENT.CRICKET.PlayingXIHub.Matches.prototype.openModal=function(t){t&&!this.votingPanels[t]&&(this.votingPanels[t]=new PULSE.CLIENT.CRICKET.PlayingXIHub.VotingPanel(this.$votingModal,this.tournament,t)),this.$votingModal.addClass("active")},PULSE.CLIENT.CRICKET.PlayingXIHub.Matches.prototype.setMatches=function(t){var e="";t.length&&this.$container.empty();for(var a=0,i=t.length;a<i;a++){var s=t[a];if(-1===_.indexOf(this.matchIds,s)){var n=this.tournament.getMatchById(s);if(n.canShowPlayerVotingResults()){var o={};o.matches=[n.getFullModel("dddd d mmmm yyyy")],e+=PULSE.CLIENT.Template.getHtml(this.template,o)}}else if(e){var r=this.$container.find('[data-match-id="'+s+'"]');r.insertBefore(e),e=""}}e&&this.$container.append(e);var l=document.querySelectorAll('[data-widget="match-venue-image"]');l.length&&new PULSE.app.MatchVenue(l),this.matchIds=t},PULSE.CLIENT.CRICKET.PlayingXIHub.Matches.prototype.updateMatch=function(t){var e=this.tournament.getMatchById(t),a={},i=this.$container.find('[data-match-id="'+t+'"]');a.match=e.getFullModel("dddd d mmmm yyyy"),PULSE.CLIENT.Template.replace("playing-xi-voting-match",i,a)},PULSE.CLIENT.CRICKET.PlayingXIHub.Matches.prototype.empty=function(){this.matchIds=[],this.$container.empty()},PULSE.CLIENT.CRICKET.PlayingXIHub.Matches.prototype.publish=function(){var t={},e=this;t.matches=$.map(this.matchIds,function(t){var a=e.tournament.getMatchById(t),i=a.getFullModel("dddd d mmmm yyyy");return i.matchLink=this.urlGenerator.getMatchURL(t),i}),PULSE.CLIENT.Template.publish(this.templates.matches,this.$container.find(".matchesList"),t)},!PULSE)var PULSE={};if(PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayingXIHub||(PULSE.CLIENT.CRICKET.PlayingXIHub={}),PULSE.CLIENT.CRICKET.PlayingXIHub.VotingPanel=function(t,e,a){this.$container=t,this.tournament=e,this.setSubscriptions(),a&&this.setMatch(a)},PULSE.CLIENT.CRICKET.PlayingXIHub.VotingPanel.prototype.setSubscriptions=function(){var t=this;$("body").on("scoring/update",function(e,a){a.success&&a.matchId===t.matchId&&!t.initialised&&t.init()})},PULSE.CLIENT.CRICKET.PlayingXIHub.VotingPanel.prototype.setMatch=function(t){this.matchId!==t&&(this.initialised=!1,this.matchId=t,this.match=this.tournament.getMatchById(this.matchId),this.match.canShowPlayerVotingResults()?this.match.scoringData?this.init():this.match.startScoringFeed(!0):this.init())},PULSE.CLIENT.CRICKET.PlayingXIHub.VotingPanel.prototype.init=function(){this.voter=new PULSE.CLIENT.CRICKET.PlayerVote.Voter(this.$container,this.match),this.initialised=!0},!PULSE)var PULSE={};PULSE.CLIENT||(PULSE.CLIENT={}),PULSE.CLIENT.CRICKET||(PULSE.CLIENT.CRICKET={}),PULSE.CLIENT.CRICKET.PlayingXIHub||(PULSE.CLIENT.CRICKET.PlayingXIHub={}),PULSE.CLIENT.CRICKET.PlayingXIHub.Main=function(t,e,a){this.$container=$(t),this.config=e,this.tournament=a,this.$teamsDropdown=this.$container.find(".teamsFilter"),this.$teamsSelect=this.$teamsDropdown.find("ul"),this.templates={matches:"playing-xi-voting-matches",votingBase:"team-vote-hero"},PULSE.CLIENT.Template.publish(this.templates.votingBase,this.$container.find(".js-current-vote, .js-modal"),{}),this.components={matches:new PULSE.CLIENT.CRICKET.PlayingXIHub.Matches(this.$container.find(".js-list"),this.tournament)},PULSE.squads&&PULSE.schedules&&PULSE.schedules[this.tournament.tournamentName]&&(this.tournament.scheduleData=PULSE.schedules[this.tournament.tournamentName].map(function(t){return t.scheduleEntry}),this.tournament.updateMatches(),this.tournament.squadsData=PULSE.squads),this.setSubscriptions(),this.tournament.getPlayerVoteQuestionsData()},PULSE.CLIENT.CRICKET.PlayingXIHub.Main.prototype.setSubscriptions=function(){var t=this;$("body").on("player-vote/config",function(e,a){t.tournament.playerVoteQuestionsData.length&&(t.hasVotingData=!0,t.tournament.processPlayerVoteQuestions(),t.populateTeams(),t.update())}),$("body").on("schedule/update",function(e,a){t.tournament.scheduleData.length&&t.update()})},PULSE.CLIENT.CRICKET.PlayingXIHub.Main.prototype.update=function(){this.setData(),this.hasVotingData&&(this.components.featured?this.components.featured.setMatch(this.featuredMatchId):this.components.featured=new PULSE.CLIENT.CRICKET.PlayingXIHub.VotingPanel(this.$container.find(".teamXIVoteHero"),this.tournament,this.featuredMatchId),this.components.matches.setMatches(this.matches),this.processedVoting||this.tournament.processPlayerVoteQuestions())},PULSE.CLIENT.CRICKET.PlayingXIHub.Main.prototype.setData=function(){if(this.hasVotingData){this.featuredMatchId=void 0,this.matches=[];for(var t=0;t<this.tournament.playerVoteQuestionsData.length;t++){var e=this.tournament.playerVoteQuestionsData[t],a=this.tournament.getMatchById(e.matchId.name);if(e.votingOpen&&(!this.teamId||a.hasTeamWithId(this.teamId))){this.featuredMatchId=e.matchId.name;break}}if(!this.featuredMatchId)if(this.tournament.liveMatches.length){var i=_.last(this.tournament.liveMatches),a=this.tournament.getMatchById(i);if(!this.teamId||a.hasTeamWithId(this.teamId))this.featuredMatchId=i;else for(var s=!1,t=this.tournament.playerVoteQuestionsData.length-1;t>=0;t--){var e=this.tournament.playerVoteQuestionsData[t],a=this.tournament.getMatchById(e.matchId.name);if(e.matchId.name===i&&(s=!0),s&&(!this.teamId||a.hasTeamWithId(this.teamId))){this.featuredMatchId=e.matchId.name;break}}}else for(var t=this.tournament.playerVoteQuestionsData.length-1;t>=0;t--){var e=this.tournament.playerVoteQuestionsData[t],a=this.tournament.getMatchById(e.matchId.name);if(e.showResults&&(!this.teamId||a.hasTeamWithId(this.teamId))){this.featuredMatchId=e.matchId.name;break}}this.featuredMatchId||(this.featuredMatchId=this.tournament.scheduleData[0].matchId.name);var n=!1;this.matches=[];for(var t=this.tournament.scheduleData.length-1;t>=0;t--){var o=this.tournament.scheduleData[t],a=this.tournament.getMatchById(o.matchId.name);!n||this.teamId&&!a.hasTeamWithId(this.teamId)||this.matches.push(o.matchId.name),o.matchId.name===this.featuredMatchId&&(n=!0)}}},PULSE.CLIENT.CRICKET.PlayingXIHub.Main.prototype.populateTeams=function(){if(!this.teamsPopulated){for(var t=this.$container.find(".js-dropdown"),e=this.$container.find(".js-drop-down-options"),a=this.tournament.getTeamListFromSchedule({matchState:this.matchType,venueId:this.venueId}),i='<li tabindex="0" role="button" class="drop-down__dropdown-list__option" data-option="-1">All Teams</li>',s=0;s<a.length;s++){var n=a[s];i+='<li tabindex="0" role="button" class="drop-down__dropdown-list__option" data-option="'+n.id+'">'+n.shortName+"</li>"}e.html(i);var o=this;a.length>0&&!this.teamId&&(t.removeClass("u-hide"),this.dropdownController=new PULSE.app.common.filterDropDown({update:function(t){"CRICKET_TEAM"===t.type&&(o.teamId=t.key,o.update())}},this.$container[0])),this.teamsPopulated=!0}},window.WidgetController.init("playing-xi-hub",PULSE.CLIENT.CRICKET.PlayingXIHub.Main),function(t,e,a){"use strict";var i=function(t){var e=t.split(":");return e[e.length-1]},s=function(t){var e=t?t:{},s=new a.Facebook,n=new a.Instagram,o=new a.Twitter;switch(e.network){case"TWITTER":e=o.getTweetModel(e.data),e.logo="twitter-w",e.containerClass="twitter",e.action1=e.photo&&e.photo.length>0?"reply-w":"reply-black",e.action2=e.photo&&e.photo.length>0?"retweet-w":"retweet-black",e.action3=e.photo&&e.photo.length>0?"heart-w":"heart-black",e.idTrimmed=i(e.id);break;case"INSTAGRAM":e=n.getInstagramModel(e.data),e.logo="instagram-w",e.containerClass="instagram",e.action1=e.photo&&e.photo.length>0?"heart-outline-w":"heart-outline-b",e.action2=e.photo&&e.photo.length>0?"instagram-comment-w":"instagram-comment-b";break;case"FACEBOOK":e=s.getFacebookModel(e.data),e.logo="facebook-w",e.containerClass="facebook",e.action1=e.photo&&e.photo.length>0?"facebook-like-w":"facebook-like-b",e.action2=e.photo&&e.photo.length>0?"facebook-comment-w":"facebook-comment-b"}return e.cardClass=e.photo&&e.photo.length>0?"imageCard":"textCard",e.agoLabel="time ago",e.atChar=e.user.account?"@":"",e};t.socialFeed=function(t){var e=this;e.element=t,e.loaderContainer=e.element.querySelector(".js-loading"),e.slideContainer=e.element.querySelector(".js-content-slider-content"),e.prevBtn=e.element.querySelector(".js-slide-prev"),e.nextBtn=e.element.querySelector(".js-slide-next"),e.paginatorContainer=e.element.querySelector(".js-content-slider-paginator"),e.itemsPerPage=e.element.getAttribute("data-slide"),e.streamId=e.element.getAttribute("data-stream-id"),e.pageSize=Number(e.element.getAttribute("data-limit")),e.pageSize>24&&(e.pageSize=24),e.itemExtraClasses=e.element.getAttribute("data-item-extra-classes"),e.pageDefault=8,e.initFeed()},t.socialFeed.prototype.initFeed=function(){var t=this;t.getSocialFeed(t.pageSize)},t.socialFeed.prototype.getSocialFeed=function(t){var e=this,i="";if(e.streamId){i=a.createCanaryPathFromId(e.streamId),i+=t?"/?pageSize="+t:"/?pageSize=16";var s={url:i,method:"GET",callback:e.renderSocial,target:this};e.startData(s)}else console.warn("Please define a stream id in your widget")},t.socialFeed.prototype.startData=function(t){var a=this;self.dm?a.dm.start():a.dm=e.data.manager.add(t)},t.socialFeed.prototype.stopData=function(){var t=this;t.dm.stop()},t.socialFeed.prototype.renderSocial=function(e){var i=this,n={items:[],testSubTemplate:t.templating.render({test:"11r11"},"twitter-card")};e&&e.content&&e.content.length>0&&e.content.forEach(function(e){n.items.push({subTemplate:t.templating.render(s(e),s(e).containerClass+"-card"),extraClasses:i.itemExtraClasses})}),i.slideContainer.innerHTML=t.templating.render(n,"social-feed");var o={container:i.element,perPage:i.itemsPerPage,scrollContainer:i.slideContainer,sliderElements:i.slideContainer.querySelectorAll(".js-thumb"),nextButton:i.nextBtn,prevButton:i.prevBtn,scrollList:i.element.querySelector(".js-scroll-list"),nudgeLeftClass:"video-slider__list--nudge-left",nudgeRightClass:"video-slider__list--nudge-right",pagerActiveClass:"video-slider__pager--active",paginatorContainer:i.paginatorContainer};new a.ContentSlider(o)};var n=document.querySelector('[data-widget="social-slider"]');n&&new t.socialFeed(n)}(PULSE.app,PULSE.core,PULSE.app.common),function(t,e,a){"use strict";var i=function(){console.log(arguments)},s=function(){console.log(arguments)},n=function(e){var a=this;if(e&&e.length)for(var i=a.container.querySelectorAll('[data-social-service="'+e[0].feedType.toUpperCase()+'"]'),s=0;s<i.length;s++){var n=i[s],o=e[s];o&&n&&(n.innerHTML=t.templating.render({item:o},a.templates[o.feedType]))}},o=function(t){var i={references:t.references,streamId:t.streamId,pageSize:0,interval:t.interval?parseInt(t.interval):null};t.requestConfigurations={TWITTER:e.object.extend({},i,{network:"TWITTER"}),FACEBOOK:e.object.extend({},i,{network:"FACEBOOK"}),INSTAGRAM:e.object.extend({},i,{network:"INSTAGRAM"})};for(var s=0;s<t.socialElements.length;s++){var n=t.socialElements[s],o=n.getAttribute("data-social-service");o&&t.requestConfigurations[o].pageSize++}for(var o in t.requestConfigurations)t.requestConfigurations.hasOwnProperty(o)&&t.requestConfigurations[o].pageSize>0&&(t.components[o]=new a.SocialFeed(t.requestConfigurations[o]),t.components[o].fetchFeed(e.object.extend({},t.socialStreamOptions,{feedName:"ipl_curated_social_"+o})))};t.SocialSummaryCurated=function(e,a){var r=this;r.container=e[0],r.templates={twitter:"twitter",facebook:"facebook",instagram:"instagram"},r.references=a["data-references"],r.streamId=a["data-stream-id"],r.template=a["data-template"]||"social_feed",r.interval=a["data-interval"]||12e4,r.socialElements=r.container.querySelectorAll(".js-social-item"),r.tallyContainer=r.container.querySelector(".js-tally"),r.followContainer=r.container.querySelector(".js-follow-us"),r.components={};var a={references:r.references,streamId:r.streamId,pageSize:r.pageSize,interval:r.interval?parseInt(r.interval):null};r.socialStreamOptions={successCallback:i.bind(r),errorCallback:s.bind(r),render:n.bind(r),start:!0,forceCallback:!1},r.followContainer&&(r.followContainer.innerHTML=t.templating.render({accounts:PULSE.CLIENT.CRICKET.IPL.ACCOUNTS},"follow_us_on")),o(r)},t.SocialSummaryCurated.prototype.deactivate=function(){this.socialFeed&&this.socialFeed.deactivate()},t.SocialSummaryCurated.prototype.activate=function(){this.socialFeed&&this.socialFeed.activate()},window.WidgetController.init("social-summary-curated",t.SocialSummaryCurated)}(PULSE.app,PULSE.core,PULSE.app.common),function(t,e,a){"use strict";var i=function(){console.log(arguments)},s=function(){console.log(arguments)},n=function(e){for(var a=this,i=0;i<a.socialElements.length;i++){var s=a.socialElements[i],n=e[i];n&&s&&(s.innerHTML=t.templating.render({item:n},a.templates[n.feedType]))}};t.SocialSummary=function(e,o){var r=this;r.container=e[0],r.templates={twitter:"twitter",facebook:"facebook",instagram:"instagram"},r.references=o["data-references"],r.streamId=o["data-stream-id"],r.template=o["data-template"]||"social_feed",r.interval=o["data-interval"]||3e4,r.pageSize=o["data-limit"]||4,r.socialElements=r.container.querySelectorAll(".js-social-item"),r.tallyContainer=r.container.querySelector(".js-tally"),r.followContainer=r.container.querySelector(".js-follow-us");var o={references:r.references,streamId:r.streamId,pageSize:r.pageSize,interval:r.interval?parseInt(r.interval):null},l={feedName:"ecb_socialFeed",successCallback:i.bind(r),errorCallback:s.bind(r),render:n.bind(r),start:!0,forceCallback:!1};r.followContainer&&(r.followContainer.innerHTML=t.templating.render({accounts:PULSE.CLIENT.CRICKET.IPL.ACCOUNTS},"follow_us_on")),r.socialFeed=new a.SocialFeed(o),r.socialFeed.fetchFeed(l)},t.SocialSummary.prototype.deactivate=function(){this.socialFeed&&this.socialFeed.deactivate()},t.SocialSummary.prototype.activate=function(){this.socialFeed&&this.socialFeed.activate()},window.WidgetController.init("social-summary",t.SocialSummary)}(PULSE.app,PULSE.core,PULSE.app.common),function(t){t.TallyTrendings=function(t){this.$container=$(t);var e=this.$container.find(".js-tally");this.$count=e.length>0?e:this.$container,this.twitter=PULSE.CLIENT.getTwitterInstance(),this.template=this.$container.attr("data-template")||!1,this.setSubscriptions(),"social-tally"===this.$container.attr("data-widget")?(this.name=PULSE.CLIENT.CRICKET.IPL.CANARY.TALLY,this.twitter.getTally(this.name,{fileName:this.name,start:!0})):(this.name=PULSE.CLIENT.CRICKET.IPL.CANARY.TRENDING,this.team=this.$container.attr("data-team"),this.twitter.getRankedTopics(this.name,{fileName:this.name,start:!0}))},t.TallyTrendings.prototype.deactivate=function(){this.twitter.stopTally(this.name,{fileName:this.name}),this.twitter.stopRankedTopics(this.name,{fileName:this.name})},t.TallyTrendings.prototype.setSubscriptions=function(){var t=this;$("body").on("twitter/tally",function(e,a){a.success&&a.name===t.name&&t.refreshTally()}),$("body").on("twitter/trending",function(e,a){a.success&&a.name===t.name&&t.refreshTeam()})},t.TallyTrendings.prototype.changeFeed=function(t,e){t===PULSE.CLIENT.CRICKET.IPL.CANARY.TALLY?(this.twitter.stopRankedTopics(this.name),this.name=t,this.twitter.getTally(this.name,{fileName:this.name,start:!0}),this.team=""):(this.team=e,this.twitter.stopTally(this.name),this.name=t,this.twitter.getRankedTopics(this.name,{fileName:this.name,start:!0}))},t.TallyTrendings.prototype.refreshTally=function(){var t=this.twitter.getTweetCount(this.name);this.$count.html(t)};var e=function(t){var e=PULSE.CLIENT.CRICKET.Metadata[0];for(var a in e.teams){var i=e.teams[a];if(i.fullName===t)return i.abbreviation}};t.TallyTrendings.prototype.refreshTeam=function(){var a=this.twitter.getTrendingModel(this.name).rankings,i=0,s=!1;if(this.team)for(var n=0;n<a.length;n++)a[n].label===this.team&&(s=a[n]);else s=a[0];s.abbreviation=e(s.label);var i="";i=this.template?t.templating.render(s,this.template):PULSE.CLIENT.Util.commafy(s.count),this.$count.html(i)};for(var a=document.querySelectorAll('[data-widget="social-tally"],[data-widget="social-ranked-team"]'),i=0,s=a.length;i<s;i++)new t.TallyTrendings(a[i])}(PULSE.app),function(t,e,a){"use strict";var i=function(e){if(e.header){e.teamOptions=[{key:"-1",value:"All Teams"}];for(var i in e.teams)e.teams.hasOwnProperty(i)&&e.teamOptions.push({key:i,value:e.teams[i].fullName});var s=t.templating.render({options:e.teamOptions,current:"All Teams",label:"Filter by Team"},"filter_dropdown");e.header.innerHTML=s,e.dropdownController=new a.filterDropDown(e,e.header)}};t.SocialSummaryFiltered=function(e,a,s){var n=this;n.$container=e,n.config=a,n.tournament=s,n.socialSummary=new t.SocialSummary(n.$container,n.config),n.tally=!1,n.trendingTally=!1,n.teams=n.tournament.teams,n.header=n.$container[0].querySelector(".js-header"),n.socialTally=n.$container[0].querySelector(".js-social-tally"),i(n)},t.SocialSummaryFiltered.prototype.update=function(e){var a=this;a.socialSummary.deactivate(),a.tally?a.tally.deactivate():PULSE.CLIENT.getTwitterInstance().stopTally(PULSE.CLIENT.CRICKET.IPL.CANARY.TALLY,{fileName:PULSE.CLIENT.CRICKET.IPL.CANARY.TALLY}),a.trendingTally?a.trendingTally.deactivate():PULSE.CLIENT.getTwitterInstance().stopTally(PULSE.CLIENT.CRICKET.IPL.CANARY.TRENDING,{fileName:PULSE.CLIENT.CRICKET.IPL.CANARY.TRENDING});var i=!1;if("-1"!==e.key){var s=e.key,n=a.teams[s],i=$.extend({},a.config,{"data-references":"CRICKET_TEAM:"+s});a.socialTally.innerHTML=t.templating.render(n,"team_tally_large"),a.socialTally.setAttribute("data-widget","social-ranked-team"),a.socialTally.setAttribute("data-team",n.fullName),a.socialTally.setAttribute("data-tally",""),a.trendingTally=!1}else a.socialTally.innerHTML=t.templating.render(n,"social_tally_large"),a.socialTally.setAttribute("data-widget","social-tally"),a.socialTally.setAttribute("data-team",""),a.socialTally.setAttribute("data-tally","ipl"),a.trendingTally=a.tally=new t.TallyTrendings(a.socialTally.querySelector('[data-widget="social-ranked-team"]'));a.socialSummary=new t.SocialSummary(a.$container,i||a.config),a.tally=new t.TallyTrendings(a.socialTally)},window.WidgetController.init("social-summary-filtered",t.SocialSummaryFiltered)}(PULSE.app,PULSE.core,PULSE.app.common);